references  = {}
references['fingerprint.goodix.default'] = """001081e0	LAB_001081e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001085c4	LAB_001085c4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00108d50	LAB_00108d50	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109104	LAB_00109104	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010929c	LAB_0010929c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109dac	LAB_00109dac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a5f8	LAB_0010a5f8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010abf4	LAB_0010abf4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010af24	LAB_0010af24	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b1fc	LAB_0010b1fc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b530	LAB_0010b530	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b670	LAB_0010b670	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b870	LAB_0010b870	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b994	LAB_0010b994	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bac4	LAB_0010bac4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bcd8	LAB_0010bcd8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bddc	LAB_0010bddc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bf4c	LAB_0010bf4c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c040	LAB_0010c040	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c150	LAB_0010c150	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c2c4	LAB_0010c2c4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c3d4	LAB_0010c3d4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c4ac	LAB_0010c4ac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c5e4	LAB_0010c5e4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010c848	LAB_0010c848	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010cb80	LAB_0010cb80	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010ccdc	LAB_0010ccdc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010cf88	LAB_0010cf88	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010d070	LAB_0010d070	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010d360	LAB_0010d360	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010d6f4	LAB_0010d6f4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010da8c	LAB_0010da8c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010dd00	LAB_0010dd00	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010e9fc	LAB_0010e9fc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010eb88	LAB_0010eb88	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010eca8	LAB_0010eca8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010edb4	LAB_0010edb4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL"""

references['gxfingerprint.default'] = """001040e8	LAB_001040e8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00104738	LAB_00104738	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010499c	LAB_0010499c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00104ba8	LAB_00104ba8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00104d28	LAB_00104d28	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00104dc4	LAB_00104dc4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00104f4c	LAB_00104f4c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001050e4	LAB_001050e4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001056e8	LAB_001056e8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001059d0	LAB_001059d0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00106074	LAB_00106074	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00106134	LAB_00106134	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010666c	LAB_0010666c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00106834	LAB_00106834	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001068c4	LAB_001068c4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001069cc	LAB_001069cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00106b58	LAB_00106b58	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00106d4c	LAB_00106d4c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00107100	LAB_00107100	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00107430	LAB_00107430	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00107b80	LAB_00107b80	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00107d94	LAB_00107d94	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00107f30	LAB_00107f30	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00108020	LAB_00108020	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00108630	LAB_00108630	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001089d8	LAB_001089d8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00108d00	LAB_00108d00	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109284	LAB_00109284	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001093c4	LAB_001093c4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109430	LAB_00109430	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001094a0	LAB_001094a0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109518	LAB_00109518	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001095ac	LAB_001095ac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109610	LAB_00109610	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001096a0	LAB_001096a0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109930	LAB_00109930	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001099a0	LAB_001099a0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109a78	LAB_00109a78	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109c1c	LAB_00109c1c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109c8c	LAB_00109c8c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109cf8	LAB_00109cf8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109d68	LAB_00109d68	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109dd8	LAB_00109dd8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109e50	LAB_00109e50	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109ec8	LAB_00109ec8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109f6c	LAB_00109f6c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00109fe4	LAB_00109fe4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a1b0	LAB_0010a1b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a22c	LAB_0010a22c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a2a4	LAB_0010a2a4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a31c	LAB_0010a31c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a394	LAB_0010a394	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a40c	LAB_0010a40c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a484	LAB_0010a484	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a4f4	LAB_0010a4f4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a684	LAB_0010a684	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a7b0	LAB_0010a7b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010a984	LAB_0010a984	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010ac8c	LAB_0010ac8c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010acf0	LAB_0010acf0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010adf0	LAB_0010adf0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010af08	LAB_0010af08	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010afd8	LAB_0010afd8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b094	LAB_0010b094	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b2c0	LAB_0010b2c0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b34c	LAB_0010b34c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b428	LAB_0010b428	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b4bc	LAB_0010b4bc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b594	LAB_0010b594	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b600	LAB_0010b600	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b66c	LAB_0010b66c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b6f8	LAB_0010b6f8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b7ac	LAB_0010b7ac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b834	LAB_0010b834	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b8c0	LAB_0010b8c0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b95c	LAB_0010b95c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010b9dc	LAB_0010b9dc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010ba68	LAB_0010ba68	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bb38	LAB_0010bb38	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bb9c	LAB_0010bb9c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bc1c	LAB_0010bc1c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010bc8c	LAB_0010bc8c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010ca38	LAB_0010ca38	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010d68c	LAB_0010d68c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010d8e0	LAB_0010d8e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010df94	LAB_0010df94	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0010e248	LAB_0010e248	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL"""

references['libfp_client'] = """0010ff24	LAB_0010ff24	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001102e0	LAB_001102e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110594	LAB_00110594	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110984	LAB_00110984	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110b40	LAB_00110b40	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110c2c	LAB_00110c2c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110d50	LAB_00110d50	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110e34	LAB_00110e34	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00110f20	LAB_00110f20	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011100c	LAB_0011100c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001110e8	LAB_001110e8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001111c4	LAB_001111c4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001112a0	LAB_001112a0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011137c	LAB_0011137c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011146c	LAB_0011146c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111558	LAB_00111558	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111638	LAB_00111638	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111724	LAB_00111724	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111830	LAB_00111830	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011190c	LAB_0011190c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111a10	LAB_00111a10	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111b24	LAB_00111b24	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111c00	LAB_00111c00	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111cf4	LAB_00111cf4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111de0	LAB_00111de0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111ed4	LAB_00111ed4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00111fb0	LAB_00111fb0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001120f4	LAB_001120f4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001121d4	LAB_001121d4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001122b4	LAB_001122b4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001123a8	LAB_001123a8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011249c	LAB_0011249c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001125d8	LAB_001125d8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112734	LAB_00112734	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112828	LAB_00112828	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112904	LAB_00112904	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001129e0	LAB_001129e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112acc	LAB_00112acc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112ba8	LAB_00112ba8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00112e24	LAB_00112e24	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113074	LAB_00113074	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001131f8	LAB_001131f8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113328	LAB_00113328	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001135f0	LAB_001135f0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001136dc	LAB_001136dc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001137b0	LAB_001137b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011389c	LAB_0011389c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113970	LAB_00113970	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113a44	LAB_00113a44	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113b84	LAB_00113b84	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113cbc	LAB_00113cbc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113d90	LAB_00113d90	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113e98	LAB_00113e98	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113fd4	LAB_00113fd4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001140d4	LAB_001140d4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001141a8	LAB_001141a8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001142d8	LAB_001142d8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114454	LAB_00114454	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114528	LAB_00114528	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114614	LAB_00114614	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114700	LAB_00114700	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001147d4	LAB_001147d4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001148a8	LAB_001148a8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011497c	LAB_0011497c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114a50	LAB_00114a50	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114b3c	LAB_00114b3c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114c10	LAB_00114c10	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114cfc	LAB_00114cfc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114dd0	LAB_00114dd0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114ec4	LAB_00114ec4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114fa0	LAB_00114fa0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001150c0	LAB_001150c0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001151ac	LAB_001151ac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001152a8	LAB_001152a8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001153d4	LAB_001153d4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001154c0	LAB_001154c0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011564c	LAB_0011564c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001157ac	LAB_001157ac	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00116be8	LAB_00116be8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00116ee8	LAB_00116ee8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117094	LAB_00117094	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001173e0	LAB_001173e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001174d8	LAB_001174d8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001177ec	LAB_001177ec	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117ba8	LAB_00117ba8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117c94	LAB_00117c94	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117ed4	LAB_00117ed4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00118130	LAB_00118130	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL"""

references['libfpnav'] = """00101948	LAB_00101948	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00102c40	LAB_00102c40	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00103384	LAB_00103384	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL"""

references['libfpservice'] = """00112fd4	LAB_00112fd4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001139b4	LAB_001139b4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00113b68	LAB_00113b68	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011440c	LAB_0011440c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114674	LAB_00114674	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011475c	LAB_0011475c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00114e60	LAB_00114e60	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00115028	LAB_00115028	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001152cc	LAB_001152cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001157c0	LAB_001157c0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001158cc	LAB_001158cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001159b4	LAB_001159b4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011631c	LAB_0011631c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117028	LAB_00117028	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001171a0	LAB_001171a0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
001173ec	LAB_001173ec	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00117604	LAB_00117604	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00118a74	LAB_00118a74	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00119054	LAB_00119054	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00119378	LAB_00119378	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00119ca0	LAB_00119ca0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00119fa0	LAB_00119fa0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011a3dc	LAB_0011a3dc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011a608	LAB_0011a608	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011a7bc	LAB_0011a7bc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011a8bc	LAB_0011a8bc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011aa40	LAB_0011aa40	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011aad0	LAB_0011aad0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011acb4	LAB_0011acb4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011adcc	LAB_0011adcc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011aecc	LAB_0011aecc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011afe4	LAB_0011afe4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b0e4	LAB_0011b0e4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b1e4	LAB_0011b1e4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b354	LAB_0011b354	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b4b0	LAB_0011b4b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b5b0	LAB_0011b5b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b6e0	LAB_0011b6e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b844	LAB_0011b844	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011b970	LAB_0011b970	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011ba70	LAB_0011ba70	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011bbc8	LAB_0011bbc8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011bd80	LAB_0011bd80	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011be6c	LAB_0011be6c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011bf84	LAB_0011bf84	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c09c	LAB_0011c09c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c19c	LAB_0011c19c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c29c	LAB_0011c29c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c39c	LAB_0011c39c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c49c	LAB_0011c49c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c5b4	LAB_0011c5b4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c6b4	LAB_0011c6b4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c7cc	LAB_0011c7cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c8cc	LAB_0011c8cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011c9ec	LAB_0011c9ec	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011caf4	LAB_0011caf4	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011cc3c	LAB_0011cc3c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011cd54	LAB_0011cd54	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011ce7c	LAB_0011ce7c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011cfc8	LAB_0011cfc8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011d0e0	LAB_0011d0e0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011d288	LAB_0011d288	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011d40c	LAB_0011d40c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011e8b0	LAB_0011e8b0	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011eb5c	LAB_0011eb5c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011eec8	LAB_0011eec8	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011f128	LAB_0011f128	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011f250	LAB_0011f250	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011f7cc	LAB_0011f7cc	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011fa80	LAB_0011fa80	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011fc0c	LAB_0011fc0c	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
0011fe70	LAB_0011fe70	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL
00120278	LAB_00120278	bl __stack_chk_fail	Incoming UNCONDITIONAL_CALL"""

# Format the data
data = {}
for file, datafile in references.items():
	data[file] = []
	for entry in datafile.split('\n'):
		location, label, bl, code_unit, where, ref_type = entry.split()
		data[file].append({
				'location' : int(location, 16),
				'label' : label,
				'code_unit' : bl + ' ' + code_unit,
				'ref_type' : where + ' ' + ref_type
			})

'''
import json
with open("references.json", "w") as outfile:  
    json.dump(data, outfile) 
'''


import struct
def decode_b(data):
	d = int.from_bytes(data, "little")
	size = 25
	jmp = d & ((1 << (size+1)) - 1)
	typ = d >> (size-1)
	if typ == 0x54:
		return jmp

orig = 0x00100000
for file, file_data in data.items():
	with open("../WORKING/" + file + ".so", 'r+b') as f:
		print('#'*80)
		print("Working on " + file)
		pos = file_data[0]['location'] - orig - 128
		f.seek(pos)
		prev = None
		cur = f.read(4)
		while cur:
			offset = decode_b(cur)
			if offset:
				for entry in file_data:
					goal = entry['location'] - orig
					branch = int((pos + ((offset-1)/8))) + 4
					if goal == branch:
						print("Found XREF to " + hex(goal+orig) + " at " + hex(pos+orig+4))
						print("Need to replace " + str(cur) + " with " + str(prev) + " at " + hex(pos+orig+4))
						f.seek(pos+4)
						f.write(prev)
						#print('Nulling out the __stack_chk_fail at ' + hex(goal+orig))
						#f.seek(goal)
						#f.write(b'\xbf\xbf\x00\xbf')
			pos += 4
			f.seek(pos+4)
			prev = cur
			cur = f.read(4)

